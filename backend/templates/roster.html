{% extends "base.html" %}

{% block title %}Roster Results{% endblock %}

{% block content %}

{% if error %}
    <p class="text-red-400 text-xl font-semibold mb-4">
        {{ error }}
    </p>

    <a href="/" class="text-indigo-400 hover:underline mt-4 inline-block">
        ← Back to Home
    </a>

{% else %}

    <!-- Header -->
    <h1 class="text-3xl font-bold text-indigo-400 mb-1">
        Roster for {{ data.username }}
    </h1>

    <p class="text-gray-400 mb-4">
        {{ data.league.name }} — Season {{ data.season }}
    </p>

    <!-- POSITION GROUPS -->
    {% for pos, players in data.positions.items() %}
        {% if players %}

            <!-- Position header -->
            <h2 class="text-xl font-bold mt-8 mb-3
                       text-indigo-300
                       border-b border-white/10 pb-1
                       flex items-center gap-2
                       transition
                       hover:text-indigo-400
                       hover:border-indigo-400/40">

                <span>{{ pos }}</span>

                <span class="text-indigo-400 text-base">
                    — {{ "{:,}".format(data.totals[pos]) }}
                </span>
            </h2>

            <!-- Player list -->
            <div class="flex flex-col gap-2">

                {% for p in players %}
                    <div class="flex items-center gap-2
                            bg-zinc-800/60
                            px-2 py-1.5
                            rounded-md
                            border border-white/10
                            max-w-xs
                            transition-all duration-150
                            hover:border-indigo-400/40
                            hover:bg-zinc-800
                            hover:shadow-sm
                            hover:shadow-indigo-500/20">


                        <!-- Headshot -->
                        <img
                            src="{{ p.headshot }}"
                            class="w-8 h-8 rounded-full
                                   object-cover
                                   border border-white/20"
                        >

                        <!-- Player info -->
                        <div class="flex flex-col leading-tight">
                            <span class="text-gray-200 font-medium text-sm">
                                {{ p.name }}
                            </span>

                            <span class="text-gray-400 text-xs">
                                {% if p.ktc_pos_rank %}
                                    {{ p.position }}{{ p.ktc_pos_rank }} — {{ p.team }}
                                {% else %}
                                    {{ p.position }} — {{ p.team }}
                                {% endif %}
                            </span>

                            {% if p.ktc_value is not none %}
                                <span class="text-indigo-300 text-xs font-semibold">
                                    KTC: {{ p.ktc_value }}
                                </span>
                            {% endif %}
                        </div>

                    </div>
                {% endfor %}

            </div>

        {% endif %}
    {% endfor %}

{% endif %}

{% endblock %}
